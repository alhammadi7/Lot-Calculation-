<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Busultan â€“ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù„ÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 32px 10px;
      color: var(--text-main);
      background-attachment: fixed;
      background-size: cover;
      background-position: center;
    }

    /* Ø«ÙŠÙ… Ù„ÙŠÙ„ÙŠ */
    body.theme-dark {
      --text-main: #f5f7ff;
      --shell-border-gradient: linear-gradient(
        135deg,
        rgba(90, 151, 255, 0.9),
        rgba(255, 145, 77, 0.9)
      );
      --card-bg: radial-gradient(circle at top right, rgba(26, 31, 55, 0.96), rgba(5, 6, 19, 0.98));
      --panel-bg: radial-gradient(circle at top left, rgba(24, 30, 53, 0.96), rgba(5, 6, 19, 0.98));
      --results-bg: radial-gradient(circle at top left, rgba(20, 25, 43, 0.96), rgba(5, 6, 19, 0.98));
      --resultbox-bg: radial-gradient(circle at top left, rgba(28, 35, 64, 0.98), rgba(7, 8, 24, 0.98));
      --chip-bg: rgba(0, 0, 0, 0.25);
      --chip-border: rgba(255, 255, 255, 0.06);

      background-image:
        radial-gradient(circle at top left, rgba(10, 24, 55, 0.9), rgba(3, 7, 18, 0.95)),
        url("busultan-bg.jpg");
    }

    /* Ø«ÙŠÙ… Ù†Ù‡Ø§Ø±ÙŠ */
    body.theme-light {
      --text-main: #111320;
      --shell-border-gradient: linear-gradient(
        135deg,
        #4b8bff,
        #ffb36b
      );
      --card-bg: rgba(255, 255, 255, 0.95);
      --panel-bg: rgba(255, 255, 255, 0.97);
      --results-bg: rgba(249, 251, 255, 0.98);
      --resultbox-bg: #eff3ff;
      --chip-bg: rgba(255, 255, 255, 0.9);
      --chip-border: rgba(0, 0, 0, 0.08);

      background-image:
        linear-gradient(135deg, rgba(240, 244, 255, 0.9), rgba(210, 225, 255, 0.95)),
        url("busultan-bg.jpg");
    }

    .shell {
      width: 100%;
      max-width: 980px;
      border-radius: 26px;
      padding: 2px;
      background: var(--shell-border-gradient);
      box-shadow: 0 30px 70px rgba(0, 0, 0, 0.85);
    }

    .card {
      width: 100%;
      border-radius: 24px;
      background: var(--card-bg);
      padding: 22px 22px 24px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .brand-wrap {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    /* Ù„ÙˆÙ‚Ùˆ Busultan (ØµÙˆØ±Ø©) */
    .logo-wrapper {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
      background: #000;
    }

    .logo-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .brand {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-title {
      font-weight: 700;
      letter-spacing: 0.04em;
      font-size: 18px;
    }

    .brand-sub {
      font-size: 11px;
      opacity: 0.78;
    }

    .badge {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.06);
      margin-right: 4px;
    }

    .header-tabs {
      display: inline-flex;
      gap: 6px;
      padding: 3px;
      border-radius: 999px;
      background: var(--chip-bg);
      border: 1px solid var(--chip-border);
      margin-top: 6px;
    }

    .header-tab {
      font-size: 10px;
      padding: 4px 9px;
      border-radius: 999px;
      opacity: 0.78;
    }

    .header-tab.active {
      background: linear-gradient(135deg, #3f8cff, #945bff);
      opacity: 1;
    }

    .controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pill {
      border-radius: 999px;
      border: 1px solid var(--chip-border);
      background: var(--chip-bg);
      padding: 6px 10px;
      font-size: 11px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      color: inherit;
    }

    .pill:hover {
      opacity: 0.9;
    }

    h2 {
      font-size: 18px;
      margin-bottom: 4px;
      text-align: center;
    }

    .subtitle {
      font-size: 11px;
      text-align: center;
      opacity: 0.82;
      margin-bottom: 18px;
    }

    .layout {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .panel {
      border-radius: 18px;
      background: var(--panel-bg);
      border: 1px solid rgba(255, 255, 255, 0.07);
      padding: 14px 14px 18px;
    }

    .panel-title {
      font-size: 12px;
      opacity: 0.88;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .panel-title span {
      font-size: 10px;
      opacity: 0.6;
    }

    form {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px 16px;
    }

    @media (max-width: 700px) {
      form {
        grid-template-columns: 1fr;
      }
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    label {
      opacity: 0.96;
    }

    .example {
      font-size: 10px;
      opacity: 0.6;
    }

    input,
    select {
      width: 100%;
      border-radius: 11px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(5, 6, 16, 0.9);
      color: inherit;
      padding: 8px 11px;
      font-size: 13px;
      outline: none;
      transition: border 0.18s ease, box-shadow 0.18s ease,
        background 0.18s ease, transform 0.08s.ease;
    }

    body.theme-light input,
    body.theme-light select {
      background: rgba(245, 247, 255, 0.96);
      border-color: rgba(0, 0, 0, 0.07);
    }

    input::placeholder {
      color: rgba(255, 255, 255, 0.33);
    }

    body.theme-light input::placeholder {
      color: rgba(0, 0, 0, 0.35);
    }

    input:focus,
    select:focus {
      border-color: #3f8cff;
      box-shadow: 0 0 0 1px rgba(63, 140, 255, 0.55);
      background: rgba(6, 10, 30, 0.96);
      transform: translateY(-0.5px);
    }

    body.theme-light input:focus,
    body.theme-light select:focus {
      background: #ffffff;
    }

    select {
      cursor: pointer;
    }

    .full-row {
      grid-column: 1 / -1;
    }

    .btn-row {
      margin-top: 8px;
      display: flex;
      gap: 10px;
      justify-content: flex-start;
      flex-wrap: wrap;
      grid-column: 1 / -1;
    }

    button {
      border: none;
    }

    .btn-primary {
      border-radius: 999px;
      padding: 9px 18px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(135deg, #3f8cff, #945bff);
      color: #ffffff;
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.9);
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        background 0.12s ease, opacity 0.12s ease;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.95);
    }

    .btn-ghost {
      border-radius: 999px;
      padding: 9px 18px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(255, 255, 255, 0.04);
      color: inherit;
      transition: transform 0.12s ease, background 0.12s ease, opacity 0.12s ease;
    }

    body.theme-light .btn-ghost {
      background: rgba(0, 0, 0, 0.04);
    }

    .btn-ghost:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-1px);
    }

    body.theme-light .btn-ghost:hover {
      background: rgba(0, 0, 0, 0.08);
    }

    .results-panel {
      border-radius: 18px;
      background: var(--results-bg);
      border: 1px solid rgba(255, 255, 255, 0.07);
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      font-size: 12px;
    }

    @media (max-width: 850px) {
      .results-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 550px) {
      .results-grid {
        grid-template-columns: 1fr;
      }
    }

    .result-box {
      background: var(--resultbox-bg);
      border-radius: 13px;
      padding: 9px 11px;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .result-label {
      font-size: 11px;
      opacity: 0.66;
      margin-bottom: 3px;
    }

    .result-value {
      font-size: 15px;
      font-weight: 600;
    }

    .result-hint {
      font-size: 10px;
      opacity: 0.55;
      margin-top: 3px;
    }

    .warning {
      font-size: 10px;
      color: #ffb341;
      opacity: 0.9;
      margin-top: 2px;
    }

    .pair-tag {
      font-size: 11px;
      opacity: 0.75;
    }

    .pair-tag span {
      opacity: 0.55;
    }
  </style>
</head>
<body class="theme-dark">
  <div class="shell">
    <div class="card">
      <div class="card-header">
        <div>
          <div class="brand-wrap">
            <div class="logo-wrapper">
              <img src="busultan-logo.jpg" alt="Busultan Trading Logo" />
            </div>
            <div class="brand">
              <div class="brand-title">Busultan Trading</div>
              <div class="brand-sub" data-i18n="brandSub">
                Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ø­ØªØ±Ø§ÙÙŠØ©
                <span class="badge">MULTI-ASSET â€¢ FUNDING â€¢ R:R</span>
              </div>
            </div>
          </div>
          <div class="header-tabs">
            <div class="header-tab active" data-i18n="headerTab1">Position Sizing</div>
            <div class="header-tab" data-i18n="headerTab2">Risk Engine</div>
          </div>
        </div>

        <div class="controls">
          <button id="themeToggle" type="button" class="pill">ğŸŒ™</button>
          <button id="langToggle" type="button" class="pill">
            <span id="langLabel">AR</span>
          </button>
        </div>
      </div>

      <h2 data-i18n="title">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù„ÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>
      <div class="subtitle" data-i18n="subtitle">
        Ø­Ø¯Ø¯ Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©ØŒ ÙˆØ³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„/Ø§Ù„ÙˆÙ‚Ù ÙˆØ§Ù„Ø£Ø¯Ø§Ø© â€“ ÙˆØ³ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØªØŒ
        Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© ÙˆØ§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙˆØ§Ù„Ø£Ù‡Ø¯Ø§Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.
      </div>

      <div class="layout">
        <!-- FORM -->
        <div class="panel">
          <div class="panel-title">
            <span data-i18n="panelInputsTitle">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙÙ‚Ø©</span>
            <span data-i18n="panelInputsStep">Step 1 â€“ Inputs</span>
          </div>
          <form id="lotForm">
            <div class="field">
              <label for="balance" data-i18n="balanceLabel">Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ (USD)</label>
              <span class="example" data-i18n="balanceExample">Ù…Ø«Ø§Ù„: 10000</span>
              <input id="balance" type="number" step="0.01" placeholder="10000" required />
            </div>

            <div class="field">
              <label for="risk" data-i18n="riskLabel">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ù…Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ %</label>
              <span class="example" data-i18n="riskExample">1 = Ù…Ø®Ø§Ø·Ø±Ø© 1% Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨</span>
              <input id="risk" type="number" step="0.01" placeholder="1" required />
            </div>

            <div class="field">
              <label for="entry" data-i18n="entryLabel">Ø³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ (Entry)</label>
              <span class="example" data-i18n="entryExample">
                Ù…Ø«Ø§Ù„ EURUSD: 1.08500 â€“ USDJPY: 156.30
              </span>
              <input id="entry" type="number" step="0.00001" placeholder="1.08500" required />
            </div>

            <div class="field">
              <label for="sl" data-i18n="slLabel">Ø³Ø¹Ø± ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© (SL)</label>
              <span class="example" data-i18n="slExample">
                ÙŠÙ…ÙƒÙ† ØªØ±ÙƒÙ‡ ÙØ§Ø±Øº Ù„ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ Ù…Ù† Ù…Ø³Ø§ÙØ© Ø§Ù„ÙˆÙ‚Ù
              </span>
              <input id="sl" type="number" step="0.00001" placeholder="153.999" />
            </div>

            <div class="field full-row">
              <label for="symbol" data-i18n="symbolLabel">Ø²ÙˆØ¬ / Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ¯Ø§ÙˆÙ„</label>
              <span class="example" data-i18n="symbolExample">
                Ø£Ø²ÙˆØ§Ø¬ Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ø£Ø²ÙˆØ§Ø¬ ÙŠÙ†ØŒ ÙƒØ±ÙˆØ³ØŒ Ø°Ù‡Ø¨/ÙØ¶Ø©ØŒ Ù†ÙØ·ØŒ Ù…Ø¤Ø´Ø±Ø§Øª
              </span>
              <select id="symbol">
                <!-- COMMODITIES / FUTURES -->
                <option value="XAUUSD" data-group="metals">XAUUSD â€“ Gold (Ø°Ù‡Ø¨)</option>
                <option value="XAGUSD" data-group="metals">XAGUSD â€“ Silver (ÙØ¶Ø©)</option>
                <option value="WTI" data-group="oil">WTI â€“ Crude Oil</option>
                <option value="US100" data-group="indices">US100 â€“ Nasdaq</option>

                <!-- MAJOR FOREX -->
                <option value="EURUSD" data-group="major">EURUSD â€“ Major</option>
                <option value="USDJPY" data-group="jpy">USDJPY â€“ JPY Pair</option>
                <option value="AUDUSD" data-group="major">AUDUSD â€“ Major</option>
                <option value="NZDUSD" data-group="major">NZDUSD â€“ Major</option>
                <option value="USDCHF" data-group="major">USDCHF â€“ Major</option>
                <option value="USDCAD" data-group="major">USDCAD â€“ Major</option>

                <!-- JPY CROSSES -->
                <option value="GBPJPY" data-group="jpy">GBPJPY â€“ JPY Cross</option>
                <option value="AUDJPY" data-group="jpy">AUDJPY â€“ JPY Cross</option>
                <option value="EURJPY" data-group="jpy">EURJPY â€“ JPY Cross</option>

                <!-- CROSSES -->
                <option value="EURCAD" data-group="cross">EURCAD â€“ Cross</option>
                <option value="AUDCAD" data-group="cross">AUDCAD â€“ Cross</option>
                <option value="EURAUD" data-group="cross">EURAUD â€“ Cross</option>
              </select>
            </div>

            <div class="field">
              <label for="direction" data-i18n="directionLabel">Ù†ÙˆØ¹ Ø§Ù„ØµÙÙ‚Ø©</label>
              <span class="example" data-i18n="directionExample">
                Ù…Ù‡Ù… Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
              </span>
              <select id="direction">
                <option value="buy" data-i18n="directionBuy">Ø´Ø±Ø§Ø¡ (Buy)</option>
                <option value="sell" data-i18n="directionSell">Ø¨ÙŠØ¹ (Sell)</option>
              </select>
            </div>

            <div class="field">
              <label for="stopPips" data-i18n="stopPipsLabel">Ù…Ø³Ø§ÙØ© Ø§Ù„ÙˆÙ‚Ù (Ø¨Ø§Ù„Ù†Ù‚Ø§Ø·)</label>
              <span class="example" data-i18n="stopPipsExample">
                Ø¥Ø°Ø§ ÙƒØ§Ù† Ø­Ù‚Ù„ SL ÙØ§Ø±ØºÙ‹Ø§ Ø³ÙŠÙØ­Ø³Ø¨ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§ÙØ©
              </span>
              <input id="stopPips" type="number" step="0.1" placeholder="20" />
            </div>

            <div class="field">
              <label for="tp1" data-i18n="tp1Label">Ù‡Ø¯Ù 1 (TP1)</label>
              <span class="example" data-i18n="tp1Example">ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ = Ø¶Ø¹ÙÙŠÙ† Ø§Ù„Ø®Ø³Ø§Ø±Ø©</span>
              <input id="tp1" type="number" step="0.00001" placeholder="â€”" />
            </div>

            <div class="field">
              <label for="tp2" data-i18n="tp2Label">Ù‡Ø¯Ù 2 (TP2)</label>
              <span class="example" data-i18n="tp2Example">3 Ø£Ø¶Ø¹Ø§Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©</span>
              <input id="tp2" type="number" step="0.00001" placeholder="â€”" />
            </div>

            <div class="field">
              <label for="tp3" data-i18n="tp3Label">Ù‡Ø¯Ù 3 (TP3)</label>
              <span class="example" data-i18n="tp3Example">4 Ø£Ø¶Ø¹Ø§Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©</span>
              <input id="tp3" type="number" step="0.00001" placeholder="â€”" />
            </div>

            <div class="field">
              <label for="leverage" data-i18n="leverageLabel">Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© (Leverage)</label>
              <span class="example" data-i18n="leverageExample">Ù…Ø«Ø§Ù„: 100 Ø£Ùˆ 500</span>
              <input id="leverage" type="number" step="1" placeholder="500" value="500" />
            </div>

            <div class="btn-row">
              <button type="submit" class="btn-primary" data-i18n="btnCalc">
                Ø§Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª
              </button>
              <button type="button" id="resetBtn" class="btn-ghost" data-i18n="btnReset">
                Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
              </button>
            </div>
          </form>
        </div>

        <!-- RESULTS -->
        <div class="results-panel">
          <div class="panel-title">
            <span data-i18n="outputsTitle">Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</span>
            <span data-i18n="outputsStep">Step 2 â€“ Outputs</span>
          </div>
          <div id="results" style="display:none;">
            <div class="pair-tag">
              <span data-i18n="outputsCurrentInstr">Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</span>
              <span id="currentSymbol">â€”</span>
            </div>

            <div class="results-grid">
              <div class="result-box">
                <div class="result-label" data-i18n="lotLabel">Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª Ø§Ù„Ù…Ù‚ØªØ±Ø­</div>
                <div class="result-value" id="lotSize">0.00</div>
                <div class="result-hint" data-i18n="lotHint">
                  Ù„ÙˆØª Ù‚ÙŠØ§Ø³ÙŠ/Ù…ØµØºØ± Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø£Ø¯Ø§Ø©
                </div>
              </div>

              <div class="result-box">
                <div class="result-label" data-i18n="riskAmountLabel">
                  Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¹Ø±Ø¶ Ù„Ù„Ù…Ø®Ø§Ø·Ø±Ø© (USD)
                </div>
                <div class="result-value" id="riskAmount">0.00</div>
                <div class="result-hint" data-i18n="riskAmountHint">
                  Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ø¹Ù†Ø¯ Ø¶Ø±Ø¨ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©
                </div>
              </div>

              <div class="result-box">
                <div class="result-label" data-i18n="pipDistanceLabel">
                  Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø­ØªÙ‰ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©
                </div>
                <div class="result-value" id="pipDistance">0.0</div>
                <div class="result-hint" data-i18n="pipDistanceHint">
                  Ù…Ø­Ø³ÙˆØ¨Ø© Ø­Ø³Ø¨ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù†Ù‚Ø·Ø© Ù„Ù„Ø£Ø¯Ø§Ø©
                </div>
              </div>

              <div class="result-box">
                <div class="result-label" data-i18n="marginLabel">
                  Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§
                </div>
                <div class="result-value" id="marginRequired">0.00</div>
                <div class="result-hint" data-i18n="marginHint">
                  Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© (Notional / Leverage)
                </div>
              </div>

              <div class="result-box">
                <div class="result-label" data-i18n="notionalLabel">
                  Ø­Ø¬Ù… Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø§Ø³Ù…ÙŠ (Notional)
                </div>
                <div class="result-value" id="notional">0</div>
                <div class="result-hint" data-i18n="notionalHint">
                  ÙˆØ­Ø¯Ø§Øª ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯ (Contract Size)
                </div>
              </div>

              <div class="result-box">
                <div class="result-label" data-i18n="riskPctLabel">
                  Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯
                </div>
                <div class="result-value" id="riskPctReal">0.00%</div>
                <div class="result-hint" data-i18n="riskPctHint">
                  Ù„Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø©
                </div>
              </div>
            </div>

            <div class="warning" data-i18n="warningText">
              Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©: Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ¹Ù„ÙŠØ© ØªØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø´Ø±ÙƒØ© Ø§Ù„ÙˆØ³Ø§Ø·Ø©ØŒ
              Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ø§Ù„Ø³Ø¨Ø±ÙŠØ¯ ÙˆØ§Ù„Ø¹Ù…ÙˆÙ„Ø§ØªØŒ ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ù†Ù‚Ø·Ø© Ù„ÙƒÙ„ Ø£Ø¯Ø§Ø©. Ø·Ø¨ÙŠØ¹ÙŠ ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±
              Ø£Ù† ÙŠØªÙ†Ø§Ù‚Øµ Ø§Ù„Ù‡Ø§Ù…Ø´ Ø¹Ù†Ø¯Ù…Ø§ ØªÙˆØ³Ù‘Ø¹ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ù„Ø£Ù† Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª ÙŠÙ‚Ù„ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†ÙØ³
              Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯.
            </div>
          </div>

          <div id="noResults" style="font-size:12px; opacity:0.7; margin-top:8px;"
               data-i18n="noResultsText">
            Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙÙ‚Ø© ÙˆØ§Ø¶ØºØ· "Ø§Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª" Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ø£Ù‡Ø¯Ø§Ù.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ØªØ±Ø¬Ù…Ø§Øª Ø¹Ø±Ø¨ÙŠ / Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
    const translations = {
      ar: {
        brandSub: "Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ø­ØªØ±Ø§ÙÙŠØ©",
        headerTab1: "Position Sizing",
        headerTab2: "Risk Engine",
        title: "Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù„ÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©",
        subtitle:
          "Ø­Ø¯Ø¯ Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©ØŒ ÙˆØ³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„/Ø§Ù„ÙˆÙ‚Ù ÙˆØ§Ù„Ø£Ø¯Ø§Ø© â€“ ÙˆØ³ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØªØŒ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© ÙˆØ§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙˆØ§Ù„Ø£Ù‡Ø¯Ø§Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.",
        panelInputsTitle: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙÙ‚Ø©",
        panelInputsStep: "Step 1 â€“ Inputs",
        outputsTitle: "Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø§Ø³Ø¨Ø©",
        outputsStep: "Step 2 â€“ Outputs",
        balanceLabel: "Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ (USD)",
        balanceExample: "Ù…Ø«Ø§Ù„: 10000",
        riskLabel: "Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ù…Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ %",
        riskExample: "1 = Ù…Ø®Ø§Ø·Ø±Ø© 1% Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨",
        entryLabel: "Ø³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ (Entry)",
        entryExample: "Ù…Ø«Ø§Ù„ EURUSD: 1.08500 â€“ USDJPY: 156.30",
        slLabel: "Ø³Ø¹Ø± ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© (SL)",
        slExample: "ÙŠÙ…ÙƒÙ† ØªØ±ÙƒÙ‡ ÙØ§Ø±Øº Ù„ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ Ù…Ù† Ù…Ø³Ø§ÙØ© Ø§Ù„ÙˆÙ‚Ù",
        symbolLabel: "Ø²ÙˆØ¬ / Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ¯Ø§ÙˆÙ„",
        symbolExample: "Ø£Ø²ÙˆØ§Ø¬ Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ø£Ø²ÙˆØ§Ø¬ ÙŠÙ†ØŒ ÙƒØ±ÙˆØ³ØŒ Ø°Ù‡Ø¨/ÙØ¶Ø©ØŒ Ù†ÙØ·ØŒ Ù…Ø¤Ø´Ø±Ø§Øª",
        directionLabel: "Ù†ÙˆØ¹ Ø§Ù„ØµÙÙ‚Ø©",
        directionExample: "Ù…Ù‡Ù… Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§",
        stopPipsLabel: "Ù…Ø³Ø§ÙØ© Ø§Ù„ÙˆÙ‚Ù (Ø¨Ø§Ù„Ù†Ù‚Ø§Ø·)",
        stopPipsExample: "Ø¥Ø°Ø§ ÙƒØ§Ù† Ø­Ù‚Ù„ SL ÙØ§Ø±ØºÙ‹Ø§ Ø³ÙŠÙØ­Ø³Ø¨ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§ÙØ©",
        tp1Label: "Ù‡Ø¯Ù 1 (TP1)",
        tp1Example: "ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ = Ø¶Ø¹ÙÙŠÙ† Ø§Ù„Ø®Ø³Ø§Ø±Ø©",
        tp2Label: "Ù‡Ø¯Ù 2 (TP2)",
        tp2Example: "3 Ø£Ø¶Ø¹Ø§Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©",
        tp3Label: "Ù‡Ø¯Ù 3 (TP3)",
        tp3Example: "4 Ø£Ø¶Ø¹Ø§Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©",
        leverageLabel: "Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© (Leverage)",
        leverageExample: "Ù…Ø«Ø§Ù„: 100 Ø£Ùˆ 500",
        btnCalc: "Ø§Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª",
        btnReset: "Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„",
        outputsCurrentInstr: "Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:",
        lotLabel: "Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª Ø§Ù„Ù…Ù‚ØªØ±Ø­",
        lotHint: "Ù„ÙˆØª Ù‚ÙŠØ§Ø³ÙŠ/Ù…ØµØºØ± Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø£Ø¯Ø§Ø©",
        riskAmountLabel: "Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¹Ø±Ø¶ Ù„Ù„Ù…Ø®Ø§Ø·Ø±Ø© (USD)",
        riskAmountHint: "Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ø¹Ù†Ø¯ Ø¶Ø±Ø¨ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©",
        pipDistanceLabel: "Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø­ØªÙ‰ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©",
        pipDistanceHint: "Ù…Ø­Ø³ÙˆØ¨Ø© Ø­Ø³Ø¨ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù†Ù‚Ø·Ø© Ù„Ù„Ø£Ø¯Ø§Ø©",
        marginLabel: "Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§",
        marginHint: "Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© (Notional / Leverage)",
        notionalLabel: "Ø­Ø¬Ù… Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø§Ø³Ù…ÙŠ (Notional)",
        notionalHint: "ÙˆØ­Ø¯Ø§Øª ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯ (Contract Size)",
        riskPctLabel: "Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯",
        riskPctHint: "Ù„Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø©",
        warningText:
          "Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©: Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ¹Ù„ÙŠØ© ØªØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø´Ø±ÙƒØ© Ø§Ù„ÙˆØ³Ø§Ø·Ø©ØŒ Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ø§Ù„Ø³Ø¨Ø±ÙŠØ¯ ÙˆØ§Ù„Ø¹Ù…ÙˆÙ„Ø§ØªØŒ ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ù†Ù‚Ø·Ø© Ù„ÙƒÙ„ Ø£Ø¯Ø§Ø©. Ø·Ø¨ÙŠØ¹ÙŠ ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø£Ù† ÙŠØªÙ†Ø§Ù‚Øµ Ø§Ù„Ù‡Ø§Ù…Ø´ Ø¹Ù†Ø¯Ù…Ø§ ØªÙˆØ³Ù‘Ø¹ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ù„Ø£Ù† Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª ÙŠÙ‚Ù„ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†ÙØ³ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯.",
        noResultsText:
          "Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙÙ‚Ø© ÙˆØ§Ø¶ØºØ· \"Ø§Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØª\" Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ø£Ù‡Ø¯Ø§Ù.",
        directionBuy: "Ø´Ø±Ø§Ø¡ (Buy)",
        directionSell: "Ø¨ÙŠØ¹ (Sell)"
      },
      en: {
        brandSub: "Professional risk management",
        headerTab1: "Position Sizing",
        headerTab2: "Risk Engine",
        title: "Advanced Lot Calculator",
        subtitle:
          "Set account balance, risk %, entry/stop and instrument â€“ the tool will compute lot size, risk amount, margin and auto targets.",
        panelInputsTitle: "Trade setup",
        panelInputsStep: "Step 1 â€“ Inputs",
        outputsTitle: "Calculator outputs",
        outputsStep: "Step 2 â€“ Outputs",
        balanceLabel: "Account balance (USD)",
        balanceExample: "Example: 10000",
        riskLabel: "Risk % of account",
        riskExample: "1 = risk 1% of balance",
        entryLabel: "Entry price (Entry)",
        entryExample: "e.g. EURUSD 1.08500 â€“ USDJPY 156.30",
        slLabel: "Stop loss price (SL)",
        slExample: "Can be left empty to auto-calc from stop distance",
        symbolLabel: "Symbol / instrument",
        symbolExample: "Majors, JPY pairs, crosses, gold/silver, oil, indices",
        directionLabel: "Trade direction",
        directionExample: "Used to auto-calc SL & targets",
        stopPipsLabel: "Stop distance (pips)",
        stopPipsExample: "If SL is empty it will be derived from this distance",
        tp1Label: "Target 1 (TP1)",
        tp1Example: "Auto = 2x risk distance",
        tp2Label: "Target 2 (TP2)",
        tp2Example: "3x risk distance",
        tp3Label: "Target 3 (TP3)",
        tp3Example: "4x risk distance",
        leverageLabel: "Leverage",
        leverageExample: "Example: 100 or 500",
        btnCalc: "Calculate lot size",
        btnReset: "Reset",
        outputsCurrentInstr: "Current instrument:",
        lotLabel: "Suggested lot size",
        lotHint: "Standard / mini lot depending on instrument",
        riskAmountLabel: "Risk amount (USD)",
        riskAmountHint: "Expected loss if stop loss is hit",
        pipDistanceLabel: "Stop distance (pips)",
        pipDistanceHint: "Based on pip value for the instrument",
        marginLabel: "Approx. used margin",
        marginHint: "In USD using selected leverage (Notional / Leverage)",
        notionalLabel: "Notional position size",
        notionalHint: "Approximate contract units",
        riskPctLabel: "Actual risk % of balance",
        riskPctHint: "Check that risk matches the input value",
        warningText:
          "Important: this calculator is indicative and for educational use only. Actual values depend on your broker, account type, spreads, commissions and pip value per instrument. It is normal in risk management that used margin decreases when you widen the stop, because lot size is reduced to keep the same risk percentage.",
        noResultsText:
          "Enter trade details and press \"Calculate lot size\" to see risk and targets.",
        directionBuy: "Buy",
        directionSell: "Sell"
      }
    };

    function applyTranslations(lang) {
      const t = translations[lang];
      if (!t) return;
      document.querySelectorAll("[data-i18n]").forEach((el) => {
        const key = el.dataset.i18n;
        if (t[key]) el.textContent = t[key];
      });
      const langLabel = document.getElementById("langLabel");
      if (langLabel) langLabel.textContent = lang.toUpperCase();
      if (lang === "ar") {
        document.documentElement.lang = "ar";
        document.documentElement.dir = "rtl";
      } else {
        document.documentElement.lang = "en";
        document.documentElement.dir = "ltr";
      }
    }

    function applyTheme(theme) {
      document.body.classList.remove("theme-dark", "theme-light");
      if (theme === "light") {
        document.body.classList.add("theme-light");
      } else {
        document.body.classList.add("theme-dark");
      }
      const themeToggle = document.getElementById("themeToggle");
      if (themeToggle) themeToggle.textContent = theme === "light" ? "â˜€ï¸" : "ğŸŒ™";
    }

    const groupConfig = {
      major: { pipSize: 0.0001, pipValuePerLot: 10, contractSize: 100000 },
      jpy: { pipSize: 0.01, pipValuePerLot: 9.5, contractSize: 100000 },
      cross: { pipSize: 0.0001, pipValuePerLot: 9, contractSize: 100000 },
      metals: { pipSize: 0.1, pipValuePerLot: 10, contractSize: 100 },
      oil: { pipSize: 0.01, pipValuePerLot: 10, contractSize: 1000 },
      indices: { pipSize: 1, pipValuePerLot: 1, contractSize: 1 }
    };

    function decimalsFromPip(pipSize) {
      let d = 0;
      let v = pipSize;
      while (v < 1 && d < 8) {
        v *= 10;
        d++;
      }
      return d;
    }

    const form = document.getElementById("lotForm");
    const resultsWrapper = document.getElementById("results");
    const noResults = document.getElementById("noResults");

    let currentTheme = "dark";
    let currentLang = "ar";

    const themeToggle = document.getElementById("themeToggle");
    const langToggle = document.getElementById("langToggle");

    themeToggle.addEventListener("click", () => {
      currentTheme = currentTheme === "dark" ? "light" : "dark";
      applyTheme(currentTheme);
    });

    langToggle.addEventListener("click", () => {
      currentLang = currentLang === "ar" ? "en" : "ar";
      applyTranslations(currentLang);
    });

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const balance = parseFloat(document.getElementById("balance").value);
      const riskPercentInput = parseFloat(document.getElementById("risk").value);
      const entry = parseFloat(document.getElementById("entry").value);
      const leverage = parseFloat(
        document.getElementById("leverage").value || 1
      );

      const symbolSelect = document.getElementById("symbol");
      const symbol = symbolSelect.value;
      const groupKey =
        symbolSelect.options[symbolSelect.selectedIndex].dataset.group || "major";

      const direction = document.getElementById("direction").value;
      const stopPips = parseFloat(document.getElementById("stopPips").value);
      const slInput = document.getElementById("sl");

      if (
        !isFinite(balance) ||
        !isFinite(riskPercentInput) ||
        !isFinite(entry) ||
        balance <= 0 ||
        riskPercentInput <= 0
      ) {
        alert(
          currentLang === "ar"
            ? "Ø±Ø¬Ø§Ø¡Ù‹ ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø© ÙÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©."
            : "Please make sure core inputs are valid."
        );
        return;
      }

      const config = groupConfig[groupKey];
      if (!config) {
        alert(
          currentLang === "ar"
            ? "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø©ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ù„Ø¥Ø¶Ø§ÙØªÙ‡Ø§."
            : "No config for this instrument â€“ contact the developer to add it."
        );
        return;
      }

      let sl = parseFloat(slInput.value);

      // Ø­Ø³Ø§Ø¨ SL ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙØ§Ø±Øº
      if (!isFinite(sl)) {
        if (!isFinite(stopPips) || stopPips <= 0) {
          alert(
            currentLang === "ar"
              ? "Ø¥Ù…Ø§ Ø£Ø¯Ø®Ù„ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø£Ùˆ Ø­Ø¯Ø¯ Ù…Ø³Ø§ÙØ© Ø§Ù„ÙˆÙ‚Ù Ø¨Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ."
              : "Either enter SL price or provide stop distance in pips."
          );
          return;
        }
        const priceDistanceAuto = stopPips * config.pipSize;
        if (direction === "buy") {
          sl = entry - priceDistanceAuto;
        } else {
          sl = entry + priceDistanceAuto;
        }
        const dec = decimalsFromPip(config.pipSize);
        slInput.value = sl.toFixed(dec);
      }

      const pipDistanceRaw = Math.abs(entry - sl);
      const pipDistance = pipDistanceRaw / config.pipSize;

      if (!isFinite(pipDistance) || pipDistance === 0) {
        alert(
          currentLang === "ar"
            ? "Ù…Ø³Ø§ÙØ© ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© ØµÙØ± ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ØŒ Ø¹Ø¯Ù‘Ù„ Ø³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©."
            : "Stop distance is almost zero â€“ adjust entry or SL."
        );
        return;
      }

      const riskAmount = balance * (riskPercentInput / 100);
      const lotSize = riskAmount / (pipDistance * config.pipValuePerLot);

      const notional = lotSize * config.contractSize;
      const marginRequired = leverage > 0 ? notional / leverage : 0;
      const riskPctReal = (riskAmount / balance) * 100;

      // Ø£Ù‡Ø¯Ø§Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ© 2x / 3x / 4x
      const priceRisk = Math.abs(entry - sl);
      const dec = decimalsFromPip(config.pipSize);
      let tp1, tp2, tp3;
      if (direction === "buy") {
        tp1 = entry + 2 * priceRisk;
        tp2 = entry + 3 * priceRisk;
        tp3 = entry + 4 * priceRisk;
      } else {
        tp1 = entry - 2 * priceRisk;
        tp2 = entry - 3 * priceRisk;
        tp3 = entry - 4 * priceRisk;
      }
      document.getElementById("tp1").value = tp1.toFixed(dec);
      document.getElementById("tp2").value = tp2.toFixed(dec);
      document.getElementById("tp3").value = tp3.toFixed(dec);

      document.getElementById("lotSize").textContent = lotSize.toFixed(2);
      document.getElementById("riskAmount").textContent = riskAmount.toFixed(2);
      document.getElementById("pipDistance").textContent = pipDistance.toFixed(1);
      document.getElementById("marginRequired").textContent =
        marginRequired.toFixed(2);
      document.getElementById("notional").textContent =
        Math.round(notional).toLocaleString("en-US");
      document.getElementById("riskPctReal").textContent =
        riskPctReal.toFixed(2) + "%";
      document.getElementById("currentSymbol").textContent = symbol;

      resultsWrapper.style.display = "block";
      noResults.style.display = "none";
    });

    document.getElementById("resetBtn").addEventListener("click", function () {
      form.reset();
      resultsWrapper.style.display = "none";
      noResults.style.display = "block";
      document.getElementById("currentSymbol").textContent = "â€”";
    });

    // ØªØ´ØºÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ
    applyTheme(currentTheme);
    applyTranslations(currentLang);
  </script>
</body>
</html>
